<VirtualHost *:80>
  ServerName localhost
  Redirect permanent / https://localhost/
</VirtualHost>

<VirtualHost *:443>
  ServerName localhost

  SSLEngine on
  SSLCertificateFile /etc/ssl/certs/sp-web.crt
  SSLCertificateKeyFile /etc/ssl/private/sp-web.key

  DocumentRoot /var/www/html

  # Proxy EDS static files from separate container
  ProxyPreserveHost On
  ProxyPass /shibboleth-ds/ http://eds:80/
  ProxyPassReverse /shibboleth-ds/ http://eds:80/

  <Location /Shibboleth.sso>
    SetHandler shib-handler
  </Location>

  <Location /secure>
    AuthType shibboleth
    ShibRequestSetting requireSession 1
    Require valid-user
  </Location>

  # Optional: SP status (lokal eingeschr√§nkt lassen in echt)
  <Location /Shibboleth.sso/Status>
    SetHandler shib-handler
    Require all granted
  </Location>

  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
</VirtualHost>
